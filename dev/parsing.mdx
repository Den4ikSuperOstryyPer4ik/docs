---
title: "–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (HTML/Markdown)"
description: "–ö—Ä–∞—Å–∏–≤–µ–Ω—å–∫–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ :>"
icon: "sparkles"
---

Telegram –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É `entities` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ (–∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, —Å—Å—ã–ª–∫–∏ –∏ —Ç.–¥.). CactusLib –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É—é—Ç —ç—Ç—É —Å–∏—Å—Ç–µ–º—É, –ø–æ–∑–≤–æ–ª—è—è –≤–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–∏–≤—ã—á–Ω—ã–º–∏ **HTML** –∏–ª–∏ **Markdown**.

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–ª–∞–≥–∏–Ω–æ–≤ —Ç–µ—Ä—è—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç/–≤—ã–¥–∞—é—Ç –Ω–∞ –≤—ã—Ö–æ–¥ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –≤ —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö.

## –ü—Ä–∏–º–µ—Ä—ã

**1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫ –Ω–µ–º—É —Ç–µ–∫—Å—Ç**
```python sign.plugin icon="python" lines expandable
class MyPlugin(CactusUtils.Plugin):
    @command(doc="–î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∫ –æ—Ç–≤–µ—Ç–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é")
    def sign(self, cmd: CactusUtils.Command):
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
        reply = cmd.params.replyToMsg
        if not reply:
            cmd.answer("–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å.")
            return HookResult(strategy=HookStrategy.CANCEL)

        # 1. –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏ entities –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
        original_text = reply.messageOwner.message
        original_entities = list(reply.messageOwner.entities.toArray())

        # 2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö –≤ —É–¥–æ–±–Ω—ã–π HTML
        html_text = self.utils.HTML.unparse(original_text, original_entities)

        # 3. –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ—é –ø–æ–¥–ø–∏—Å—å
        signed_html = html_text + "\n\n‚úçÔ∏è <i>–ü–æ–¥–ø–∏—Å–∞–Ω–æ –∫—Ä—É—Ç—ã–º –∫–∞–∫—Ç—É—Å–æ–º</i>"

        # 4. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, CactusLib –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ–≥–æ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç
        cmd.answer(signed_html)

        return HookResult(strategy=HookResult.CANCEL)
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ `entities`, –º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö –≤ –ø—Ä–æ—Å—Ç–æ–π HTML, –¥–æ–ø–∏—Å—ã–≤–∞–µ–º —á—Ç–æ –Ω—É–∂–Ω–æ, –∞ –∑–∞—Ç–µ–º `cmd.answer` (–∫–æ—Ç–æ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTML-–ø–∞—Ä—Å–µ—Ä) –¥–µ–ª–∞–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É –ø–æ –æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

---

**2. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–∑ –∫–æ–¥–∞**

```python whois.plugin icon="python" lines expandable
class MyPlugin(CactusUtils.Plugin):
    @command(doc="–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ")
    def whois(self, cmd: CactusUtils.Command):
        # –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –º—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_id = 12345
        user_name = "John Doe"
        user_premium = True

        # –°–æ–±–∏—Ä–∞–µ–º HTML-—Å—Ç—Ä–æ–∫—É
        text = f"<b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</b>\n"
        text += f" ‚Ä¢ <b>ID:</b> <code>{user_id}</code>\n"
        text += f" ‚Ä¢ <b>–ò–º—è:</b> {self.utils.escape_html(user_name)}\n"
        if user_premium:
            # <emoji> - –ø—Ä–µ–º–∏—É–º-—ç–º–æ–¥–∑–∏
            text += " ‚Ä¢ <b>–°—Ç–∞—Ç—É—Å:</b> <emoji id=5807614228864962198>üëë</emoji> Premium"

        # –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
        cmd.answer(text)
        return HookResult(strategy=HookStrategy.CANCEL)
```

---

**3. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ –Ω–µ–º—É —Ç–µ–∫—Å—Ç–∞**

```python appendtext.plugin icon="python" lines expandable
class MyPlugin(CactusUtils.Plugin):
    @command(doc="–î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∫ –≤–∞—à–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é")
    def append(self, cmd: CactusUtils.Command):
        # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏ entities –∏–∑ "–æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ" —Å–æ–æ–±—â–µ–Ω–∏—è
        html_text = cmd.html()

        html_text += "\n\n‚úçÔ∏è <i>–ü–æ–¥–ø–∏—Å–∞–Ω–æ –∫—Ä—É—Ç—ã–º –∫–∞–∫—Ç—É—Å–æ–º</i>"

        # –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
        cmd.answer(html_text)
        return HookResult(strategy=HookStrategy.CANCEL)
```
